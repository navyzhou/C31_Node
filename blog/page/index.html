<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatiable" content="IE=edge">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="stylesheet" type="text/css" href="css/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="css/banse.css">
	<title>YC论坛</title>
	<style type="text/css">
		.main{
			margin-top:61px; 
		}
		.thumbnail img{
			width: 100%;
			height: 100%;
		}
		.C_T{
			text-align: center;
		}
		.C_{
			text-indent: 24px;
		}
		.content_a{
			border-top: 1px solid #e7e7e7;
			border-bottom: 1px solid #e7e7e7;
		}
		.nav_a{
			text-align: right;
		}
		.nav_a li{
			display: inline-block;
		}
		
		.badge_a{
			background-color:rgb(90, 191, 62); 
		}
		.badge_b{
			background-color:rgb(234, 56, 56); 
		}
		.badge_b:hover{
			background-color: red;
		}

		#userLogin{
			background:#ccc;
			border:1px solid #666;
			width:260px;
			height:140px;
			position: absolute;
			z-index:100;
			display: none;
			top:50%;
			left:50%;
			-webkit-transform:translate(-50%,-50%);
			-moz-transform:translate(-50%,-50%);
			transform:translate(-50%,-50%);
			padding-left:10px;
			padding-top:10px;
		}


		.contentheight{
			height:188px !important;
			overflow: hidden;
		}

		#showmore{
			line-height:40px;
			background-color: #dff0d8;
			border-color: #d6e9c6;
			color: #3c763d;
			font-size: 16px;
			text-align: center;
			cursor: pointer;
		}

		#showmore:hover{
			color:rgb(234, 56, 56);
		}
	</style>
</head>
<body>
	<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
		<div class="container">
			<div class="navbar-header"> 
	            <a class="navbar-brand fontLogo" href="#">Y&nbsp;C</a> 
	        </div>
	        <ul class="nav navbar-nav navbar-left">
	        	<li><a href="#">HTML</a></li>
	        	<li><a href="#">CSS</a></li>
	        	<li><a href="#">JAVASCRIPT</a></li>
	        </ul>
	        <form action="" class="navbar-form navbar-left">
	        	<div class="form-group">
	        		<input type="text" class="form-control" placeholder="Search">
	        		<button type="submit" class="btn btn-default">Search</button>
	        	</div>
	        </form>
	        <ul class="nav navbar-nav navbar-right">
	        	<li><a href="#"><img src="images/user.png" id="userLoginPhoto" class="userP" /></a></li>
				<li><a href="javascript:showUserLoginDiv()" id="currentloginUser">&nbsp;Login</a></li>
	        	<li id="addBlog"></li>
				<li><a href="reg.html">Reg</a></li>
	        </ul>
		</div>
	</nav>
	
	<div class="container main" id="index_blog_content">
		<!--
		<div class="row">
			<div class="col-md-3 col-sm-5 col-xs-6">
				<div class="panel panel-default">
					<div class="panel-body">
						<div class="thumbnail">
							<img src="images/user.png" alt="">
						</div>
						<div class="caption">
							<h3>Aeo</h3>
							<h6>学习是一种享受</h6>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-9 col-sm-7 col-xs-6">
				<div class="panel panel-success">
					<div class="panel-heading">
						<h4>Title</h4>
					</div>
					<div class="panel-body">
						<h3 class="C_T">Content Title</h3>
						<div class="content_a">
							<h5 class="C_">
							我希望遇见一个如你一般的人，如山间清爽的风，如古城温暖的光，从清晨到夜晚，由山野到书房，只是这最后是你，就好。
							</h5>
							<h5 class="C_">
							我希望遇见一个如你一般的人，如山间清爽的风，如古城温暖的光，从清晨到夜晚，由山野到书房，只是这最后是你，就好。
							</h5>
							<h5 class="C_">
							我希望遇见一个如你一般的人，如山间清爽的风，如古城温暖的光，从清晨到夜晚，由山野到书房，只是这最后是你，就好。
							</h5>
							<h5 class="C_">
							我希望遇见一个如你一般的人，如山间清爽的风，如古城温暖的光，从清晨到夜晚，由山野到书房，只是这最后是你，就好。
							</h5>
							<h5 class="C_">
							我希望遇见一个如你一般的人，如山间清爽的风，如古城温暖的光，从清晨到夜晚，由山野到书房，只是这最后是你，就好。
							</h5>
							<h5 class="C_">
							我希望遇见一个如你一般的人，如山间清爽的风，如古城温暖的光，从清晨到夜晚，由山野到书房，只是这最后是你，就好。
							</h5>
							<h5 class="C_">
							我希望遇见一个如你一般的人，如山间清爽的风，如古城温暖的光，从清晨到夜晚，由山野到书房，只是这最后是你，就好。
							</h5>
							<h5 class="C_">
							我希望遇见一个如你一般的人，如山间清爽的风，如古城温暖的光，从清晨到夜晚，由山野到书房，只是这最后是你，就好。
							</h5>
						</div>
					</div>
					<div class="btnAll">
						<ul class="nav nav_a">
						<li><a href=""><span class="badge badge_a">4</span>&nbsp;收藏</a></li>
						<li><a href=""><span class="badge badge_a">4</span>&nbsp;推荐</a></li>
						<li><a href=""><span class="badge badge_b">4</span>&nbsp;反对</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>-->
	</div>
	<p id="showmore">点击加载更多</p>
	<div id="userLogin">
		用户名：<input type="text" name="uname" id="index_uname" /> <br/><br/>
		&nbsp;&nbsp;&nbsp;&nbsp;密码：<input type="password" name="pwd" id="index_pwd" /> <br/><br/>
		<center><input type="button" value="登录" onclick="userLogin()"></center>
	</div>
</body>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/bootstrap.js"></script>
<script type="text/javascript">
	//显示登录框
	function showUserLoginDiv(){
		$("#userLogin").css("display","block");
	}

	//用户登录
	function userLogin(){
		var uname= $.trim( $("#index_uname").val() );
		var pwd= $.trim( $("#index_pwd").val() );

		$.post("/userLogin",{uname:uname,pwd:pwd},function(data){
			if(data.error){ //说明有问题
				if(data.error=="0"){
					alert("用户名或密码不能为空...");
				}else if(data.error=="1"){
					alert("数据库连接失败...");
				}else if(data.error=="2"){
					alert("执行查询语句失败...");
				}else if(data.error=="3"){
					alert("用户名或密码错误...");
				}
			}else{ //如果成功,则将头部的当前的用户信息改掉
				$("#userLogin").css("display","none");
				$("#userLoginPhoto").attr({src:data.photo,onclick:"userLoginout()"});
				$("#currentloginUser").attr("href","#").text(data.uname);
				$("#addBlog").append($("<a href='back/blog.html' id='addBlogInfo'>写文章</a>"));
				$("#index_uname").val("");
				$("#index_pwd").val("");
			}
		},"json");
	}

	function userLoginout(){ //用户注销
		$.get("/userLoginOut",null,function(data){
			$("#userLoginPhoto").attr("src","images/user.png").removeAttr("onclick");
			$("#addBlogInfo").remove();
			$("#currentloginUser").attr("href","javascript:showUserLoginDiv()").text("Login");
		});
	}

	$(function(){
		//发一个请求，查看用户是否已经登录
		$.get("/checkUserLogin",null,function(data){
			if(data.error){ //说明没有登录

			}else{
				$("#userLoginPhoto").attr({src:data.photo,onclick:"userLoginout()"});
				$("#currentloginUser").attr("href","#").text(data.uname);
				$("#addBlog").append($("<a href='back/blog.html' id='addBlogInfo'>写文章</a>"));
			}
		},"json");

		//获取所有文章信息
		$.get("/getAllArticle",null,function(data){
			if(data.error){
				alert("查询文章失败...");
			}else{
				var str="";
				$.each(data,function(index,item){
					str+='<div class="row"><div class="col-md-3 col-sm-5 col-xs-6"><div class="panel panel-default"><div class="panel-body"><div class="thumbnail">';
					str+='<img src="'+item.photo+'" alt=""></div><div class="caption"><h3><center>'+item.uname+'</center></h3><h6><center>学习是一种享受</center></h6></div> </div></div></div>';
					str+='<div class="col-md-9 col-sm-7 col-xs-6"><div class="panel panel-success"><div class="panel-heading"><h4><a href="show.html#'+item.aid+'" target="_blank">['+item.tname+'] '+item.title+'</a>';
					str+='</h4></div><div class="panel-body"><div class="content_a"> <h5 class="C_ contentheight">'+item.content+'</h5></div></div>';
					str+='<div class="btnAll"><ul class="nav nav_a"><li><a href=""><span class="badge badge_a">'+item.views+'</span>&nbsp;浏览次数</a></li>';
					str+='<li><a href=""><span class="badge badge_a">4</span>&nbsp;推荐</a></li>';
					str+='<li><a href=""><span class="badge badge_b">4</span>&nbsp;反对</a></li></ul></div></div></div></div>';
				});
				$("#index_blog_content").html(str);
			}
		},"json");
	});
</script>
</html>